const N=(t,n)=>Array.from(t.querySelectorAll(n)),I=(t,n,e,o)=>t&&t.addEventListener(n,e,o),ft=(t,n=300)=>{let e;return(...o)=>{clearTimeout(e),e=setTimeout(()=>t(...o),n)}},p={courses:[],filtered:[],sort:{key:null,dir:1},view:{panel:"list",semester:"first"}},J="wd-courses-capture";function pt(){let t=document.getElementById(J);return t||(t=document.createElement("div"),t.id=J,t.style.all="initial",t.style.position="fixed",t.style.bottom="16px",t.style.right="16px",t.style.zIndex="2147483647",t.attachShadow({mode:"open"}),document.documentElement.appendChild(t)),t.shadowRoot}async function ht(t){const n=chrome.runtime.getURL("src/panel.html"),e=["formatting/general.css","formatting/widget-shell.css","formatting/widget-buttons.css","formatting/floating-button.css","formatting/course-list.css","formatting/schedule-view.css","formatting/schedule-view-events.css","formatting/settings.css","colors/course-list-colors.css","colors/general-colors.css","colors/schedule-view-colors.css","colors/widget-functionality-colors.css","colors/settings-colors.css"],[o,...s]=await Promise.all([fetch(n).then(c=>c.text()),...e.map(c=>fetch(chrome.runtime.getURL(`src/css/${c}`)).then(a=>a.text()))]),i=s.join(`
`);t.innerHTML="";const r=document.createElement("style");if(r.textContent=i,t.appendChild(r),!document.querySelector('link[href*="Material+Symbols"]')){const c=document.createElement("link");c.rel="stylesheet",c.href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200",document.head.appendChild(c)}const l=document.createElement("div");return l.innerHTML=o,t.appendChild(l),{button:t.querySelector("#floating-button"),widget:t.querySelector(".widget"),search:t.querySelector("#widget-search"),refresh:t.querySelector("#widget-refresh"),exportBtn:t.querySelector("#widget-export"),settingsBtn:t.querySelector(".settings"),tableBody:t.querySelector("tbody"),tableHead:t.querySelector("thead"),tabButtons:t.querySelectorAll(".tab-button"),panels:t.querySelectorAll(".widget-panel"),scheduleGrid:t.querySelector("#schedule-grid"),semesterButtons:t.querySelectorAll(".semester-button"),footerConflicts:t.querySelector("#widget-conflicts")}}const X=t=>String(t||"").replace(/\u00A0/g," ").replace(/\s+/g," ").trim().toLowerCase();function gt(t){const e=(t?.getAttribute?.("data-automation-id")||"").match(/^columnHeader(\d+\.\d+)$/);return e?e[1]:null}function yt(t){const e=Array.from(t.querySelectorAll('th[data-automation-id^="columnHeader"]')).map((l,c)=>{const a=lt(l),m=gt(l);return{el:l,pos:c,key:m,text:a,norm:X(a)}}).filter(l=>l.text);function o(l){const c=l.map(X);let a=e.find(m=>c.includes(m.norm));return a||(a=e.find(m=>c.some(d=>m.norm.includes(d))),a||null)}const s={instructor:["instructor","instructors"],meeting:["meeting patterns","meeting pattern"],deliveryMode:["delivery mode"],title:["title","course listing"],section:["section"],instructionalFormat:["instructional format"],startDate:["start date","start"]},i={},r={};for(const[l,c]of Object.entries(s)){const a=o(c);i[l]=a?a.key:null,r[l]=a?a.pos:-1}return{colMap:i,posMap:r}}function lt(t){if(!t)return"";const n=t.querySelector("button[title]");return n?(n.getAttribute("title")||"").trim():(t.textContent||"").trim()}function bt(t){let n=String(t||"").replace(/\u00A0/g," ").trim();if(!n)return null;n=n.replace(/\s*\n\s*/g," ").trim();const e=n.match(/^\s*([A-Z][A-Z0-9_]*\s*\d{3}[A-Z]?)\s*-\s*(.+?)\s*$/);if(!e)return null;const o=e[1].trim(),i=e[2].trim().split(/\s*[-–—]\s*/).map(c=>c.trim()).filter(Boolean);let r="",l="";return r=i[0],l=i.slice(1).join(" - ").trim(),l=l.replace(/\s*:\s*/g,`:
`),{code:o,section_number:r,title:l,full:n}}function Y(t){const n=String(t||"").match(/[A-Z][A-Z0-9_]*\s*\d{2,3}[A-Z]?/);return n?n[0].replace(/\s+/g," ").trim():""}function St(t){if(!t)return[];let e=Array.from(t.querySelectorAll('[data-automation-id="menuItem"][aria-label]')).map(r=>(r.getAttribute("aria-label")||"").trim()).filter(Boolean);e.length||(e=Array.from(t.querySelectorAll('[data-automation-id="promptOption"]')).map(l=>(l.getAttribute("data-automation-label")||l.getAttribute("title")||l.textContent||"").trim()).filter(Boolean)),e.length||(e=String(t.innerText||"").split(`
`).map(r=>r.trim()).filter(Boolean));const o=/\b\d{4}-\d{2}-\d{2}\s*-\s*\d{4}-\d{2}-\d{2}\b/,s=/\b\d{1,2}:\d{2}\s*[ap]\.?m\.?\b/i,i=/\b(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\b/i;return e.filter(r=>o.test(r)&&s.test(r)&&i.test(r))}function Et(t){if(!t)return[];const e=Array.from(t.querySelectorAll('[data-automation-id="menuItem"][aria-label]')).map(r=>(r.getAttribute("aria-label")||"").trim()).filter(Boolean),o=/\b\d{4}-\d{2}-\d{2}\s*-\s*\d{4}-\d{2}-\d{2}\b/,s=/\b\d{1,2}:\d{2}\s*[ap]\.?m\.?\b/i,i=/\b(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\b/i;return e.filter(r=>o.test(r)&&s.test(r)&&i.test(r))}function Lt(t){const n=String(t||""),e=n.split("|").map(d=>d.trim()).filter(Boolean),s=(e.find(d=>/\b(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\b/.test(d))||"").split(/\s+/).join(" / "),i=e.find(d=>/\d{1,2}:\d{2}/.test(d)&&/-/.test(d))||"",r=e.find(d=>/\([A-Z]{2,}\)/.test(d))||"",l=n.match(/\bfloor\b\s*[:\-]?\s*(-?[A-Za-z0-9]+)/i),c=n.match(/\b(room|rm)\b\s*[:\-]?\s*([A-Za-z0-9]+)/i),a=l?`Floor: ${l[1]}`:"",m=c?`Room: ${c[2]}`:"";return{days:s,time:i,location:[r,[a,m].filter(Boolean).join(" | ")].filter(Boolean).join(`
`)}}function wt(t){return String(t||"").split(/\r?\n/).map(n=>n.replace(/\s+/g," ").trim()).filter(Boolean).join(`
`)}function z(t){const n=String(t||"").match(/\b(\d{4}-\d{2}-\d{2})\b/);return n?n[1]:""}function xt(t){if(!t)return"";const n=t.querySelector('[data-automation-id="promptOption"]');return(n&&(n.getAttribute("data-automation-label")||n.getAttribute("title")||n.textContent)||t.textContent||"").trim()}function Ct(t){if(!t)return!1;const n=(t.innerText||t.textContent||"").trim();return/online learning/i.test(n)?!0:Array.from(t.querySelectorAll('[data-automation-id="promptOption"]')).some(o=>{const s=(o.getAttribute("data-automation-label")||o.getAttribute("title")||o.textContent||"").trim();return/online learning/i.test(s)})}function vt(){const t=N(document,'table, [role="table"], div[data-automation-id*="grid"], div[role="grid"]');for(const n of t){const o=N(n,"thead th, [role='columnheader'], .wd-GridHeaderCell, .grid-column-header").map(r=>X(lt(r)));if(!(o.some(r=>r.includes("section"))&&(o.some(r=>r.includes("instructor"))||o.some(r=>r.includes("meeting"))||o.some(r=>r.includes("instructional format"))||o.some(r=>r.includes("format"))||o.some(r=>r.includes("status")))))continue;const i=N(n,"tbody tr, [role='rowgroup'] [role='row'], .wd-GridRow, .grid-row");if(i.length)return{root:n,rows:i}}return null}async function Q(){const t=vt();let n=[];if(t){const e=yt(t.root);for(const o of t.rows){const s=At(o,e);(s.code||s.title)&&Object.values(s).join("").trim()&&n.push(s)}}return Tt(n)}function Tt(t){const n=s=>[s.code,s.title,s.section_number].join("|").toLowerCase(),e=new Set,o=[];for(const s of t){const i=n(s);e.has(i)||(e.add(i),o.push(s))}return o}function At(t,n){const{colMap:e,posMap:o}=n,s=N(t,"td, [role='gridcell']"),i=(t.innerText||"").trim();function r(h){const V=(h.querySelector('[id^="gen-dwr-comp-"]')?.id||"").match(/^gen-dwr-comp-(\d+\.\d+)-/);return V?V[1]:null}const l=new Map;s.forEach(h=>{const E=r(h);E&&!l.has(E)&&l.set(E,h)});const c=h=>{const E=e[h];if(E!=null&&l.has(E))return l.get(E);const k=o[h];return k!=null&&k>=0&&k<s.length?s[k]:null},a=h=>{const E=e[h];if(E!=null&&l.has(E))return(l.get(E).innerText||"").trim();const k=o[h];return k!=null&&k>=0&&k<s.length?(s[k].innerText||"").trim():""},m=N(t,'[data-automation-id="promptOption"]');let d=null;for(const h of m){const E=h.getAttribute("data-automation-label")||h.getAttribute("title")||h.getAttribute("aria-label")||h.textContent||"";if(/^[A-Z][A-Z0-9_]*\s*\d{2,3}-/.test(E)){d=h;break}}!d&&m.length>0&&(d=m[0]);const L=d&&(d.getAttribute("data-automation-label")||d.getAttribute("title")||d.getAttribute("aria-label")||d.textContent)||"",D=a("title"),T=a("code"),R=a("section"),_=a("meeting"),F=a("instructionalFormat"),P=a("startDate");let A="",q=D||"",W="";const O=bt(L);O&&(A=O.code,W=O.section_number,q=O.title),A||(A=Y(T)||Y(D)||Y(i)||"");const M=h=>/\b(lab|laboratory|labratory)\b/i.test(String(h||"")),S=h=>/\bseminar\b/i.test(String(h||"")),w=h=>/\bdiscussion\b/i.test(String(h||"")),b=M(F)||M(R)||M(q)||M(L)||M(i),u=S(F)||S(R)||S(q)||S(L)||S(i),g=w(F)||w(R)||w(q)||w(L)||w(i),x=c("instructor");let C="";b||u?C="N/A":C=xt(x)||(a("instructor")||"").trim();let f;const y=e.meeting;let v=null;y!=null&&l.has(y)?v=l.get(y):o.meeting!=null&&o.meeting>=0&&o.meeting<s.length&&(v=s[o.meeting]);let B=v?St(v):[];B.length||(B=Et(t));let $={days:"",time:"",location:""},dt=z(B[0])||z(P);if(B.length){const h=B[0];$=Lt(h)}else f=(_||"").trim();const ut=c("deliveryMode");Ct(ut)&&($.location="Online"),$.days||$.time||$.location?(f=[$.days,$.time].filter(Boolean).join(" | "),$.location?f+=`
${$.location}`:f+=`
Online`):f=(_||"").trim();const mt=(F||"").trim();return{code:A,title:q,section_number:W,instructor:C,meeting:wt(f),instructionalFormat:mt,startDate:dt,meetingLines:B,isLab:b,isSeminar:u,isDiscussion:g}}const tt=t=>String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");function Mt(t){return String(t||"").replace(/[\u00A0\u200B-\u200D\uFEFF]/g," ").replace(/[ \t]+\n/g,`
`).replace(/\n[ \t]+/g,`
`).replace(/\n{2,}/g,`
`).trim()}function G(t,n){t.tableBody.innerHTML="";const e=document.createDocumentFragment();n.forEach(o=>{const s=document.createElement("tr"),i=o.isLab?"[Laboratory]":o.isSeminar?"[Seminar]":o.isDiscussion?"[Discussion]":"";s.innerHTML=`
      <td class="title">
        <div class="title-main">${o.title||""}</div>
        ${i?`<div class="muted">${i}</div>`:""}
      </td>
      <td class="code">${o.code||""}</td>
      <td class="sect">${(o.section_number||"").trim()}</td>
      <td class="instructor">${o.instructor||""}</td>
      <td class="meeting">
        ${(()=>{const r=Mt(o.meeting).split(`
`),l=(r[0]||"").trim(),c=r.slice(1).map(a=>a.replace(/[\u00A0\u200B-\u200D\uFEFF]/g,"").trim()).filter(Boolean).join(`
`);return`
            ${l?`<span class="meeting-pill">${tt(l).trim()}</span>`:""}
            ${c?`<div class="meeting-sub">${tt(c).trim()}</div>`:""}
          `})()}
      </td>
      <td class="instructionalFormat">${o.instructionalFormat||""}</td>
    `,e.appendChild(s)}),t.tableBody.appendChild(e)}function et(t){if(t=(t||"").trim().toLowerCase(),!t){p.filtered=[...p.courses];return}p.filtered=p.courses.filter(n=>["code","title","section_number","instructor","meeting","instructionalFormat"].some(e=>(n[e]||"").toLowerCase().includes(t)))}function U(t){if(!t)return;const n=p.sort.key===t?-p.sort.dir:1;p.sort={key:t,dir:n};const e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});p.filtered.sort((o,s)=>n*e.compare(o[t]||"",s[t]||""))}function Bt(t){const n=N(t.tableHead,"th[data-key]");n.forEach(e=>{I(e,"click",()=>{const o=e.getAttribute("data-key");U(o),G(t,p.filtered),n.forEach(s=>s.classList.remove("sorted-asc","sorted-desc")),e.classList.add(p.sort.dir===1?"sorted-asc":"sorted-desc")})})}const j=["Mon","Tue","Wed","Thu","Fri"],ct=8,K=21,Z=30,H=[];for(let t=ct;t<K;t++)H.push(t*60),H.push(t*60+30);H.push(K*60);const $t=/\b(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\b/g,Rt=/(\d{1,2}):(\d{2})\s*([ap])\.?m\.?/gi,nt={first:["09","08"],second:["01","12"]};function ot(t){if(!t)return null;const n=t.trim().match(/(\d{1,2}):(\d{2})\s*([ap])\.?m\.?/i);if(!n)return null;let e=Number.parseInt(n[1],10);const o=Number.parseInt(n[2],10),s=n[3].toLowerCase();return s==="p"&&e!==12&&(e+=12),s==="a"&&e===12&&(e=0),e*60+o}function Ft(t){const n=String(t||"").match($t)||[],e=String(t||"").match(Rt)||[];if(n.length===0||e.length<2)return null;const o=ot(e[0]),s=ot(e[1]);return o==null||s==null||s<=o?null:{days:[...new Set(n)],startMinutes:o,endMinutes:s,timeLabel:`${e[0]} - ${e[1]}`}}function kt(t){if(!t)return null;const n=t.split("-")[1];return nt.first.includes(n)?"first":nt.second.includes(n)?"second":null}function st(t){const n=ct*60,e=K*60;return Math.max(n,Math.min(e,t))}function Dt(t){return Math.floor(t/Z)*Z}function It(t){return Math.ceil(t/Z)*Z}function rt(t){return H.indexOf(t)}function _t(t,n){const e=new Map;j.forEach(i=>e.set(i,[]));const o=new Set;let s=0;return t.forEach(i=>{const r=i.startDate||z(i.meetingLines?.[0])||"",l=kt(r);if(l!==l)return;const c=i.meetingLines?.length?i.meetingLines:[],a=i.isLab?"[Laboratory]":i.isSeminar?"[Seminar]":i.isDiscussion?"[Discussion]":"";c.forEach(m=>{const d=Ft(m);if(!d)return;let L=st(d.startMinutes),D=st(d.endMinutes);L=Dt(L),D=It(D);const T=rt(L),R=rt(D);if(T===-1||R===-1||R<=T)return;const _=R-T;d.days.forEach(F=>{if(!e.has(F))return;const P=[F,i.code||"",i.title||"",d.timeLabel,T,_].join("|");o.has(P)||(o.add(P),e.get(F).push({id:s++,code:i.code||"",title:i.title||"",label:a,timeLabel:d.timeLabel,rowStart:T,rowSpan:_,startIdx:T,endIdx:R}))})})}),j.forEach(i=>{e.get(i).sort((r,l)=>r.startIdx-l.startIdx||r.endIdx-l.endIdx)}),e}function qt(t){const n=new Map;return j.forEach(e=>{const o=(t.get(e)||[]).slice().sort((l,c)=>l.startIdx-c.startIdx||l.endIdx-c.endIdx),s=[];let i=null,r=null;for(let l=0;l<H.length-1;l++){const c=o.filter(m=>m.startIdx<=l&&m.endIdx>l),a=c.length?c.map(m=>m.id).sort((m,d)=>m-d).join("|"):null;if(!a){i&&s.push(i),i=null,r=null;continue}if(i&&a===r){i.end=l+1;continue}i&&s.push(i),i={start:l,end:l+1,events:c,hasConflict:c.length>1},r=a}i&&s.push(i),n.set(e,s)}),n}function Ot(t){const n=new Set,e=[];return t.forEach(o=>{o.forEach(s=>{if(!s.hasConflict)return;const i=[...new Set(s.events.map(l=>l.code||l.title).filter(Boolean))];if(i.length<2)return;i.sort((l,c)=>l.localeCompare(c));const r=i.join("|");n.has(r)||(n.add(r),e.push(i))})}),e}function jt(t,n){if(!t?.footerConflicts)return;if(!n.length){t.footerConflicts.textContent="";return}const e=n.map(o=>`[${o.join(", ")}]`).join(" ");t.footerConflicts.textContent=`⚠️ The following classes are in conflict: ${e}`}function Ht(t){const n=Math.floor(t/60),e=t%60,o=String(n),s=String(e).padStart(2,"0");return`${o}:${s}`}function Pt(){const t=document.createElement("div");t.className="schedule-table-wrap";const n=document.createElement("table");n.className="schedule-table";const e=document.createElement("thead"),o=document.createElement("tr");o.innerHTML=`
    <th class="schedule-time"></th>
    ${j.map(r=>`<th class="schedule-day-head" data-day="${r}">${r}</th>`).join("")}
  `,e.appendChild(o),n.appendChild(e);const s=document.createElement("tbody");for(let r=0;r<H.length;r++){const l=document.createElement("tr"),c=document.createElement("td");c.className="schedule-time",c.textContent=Ht(H[r]),l.appendChild(c),j.forEach(a=>{const m=document.createElement("td");m.className="schedule-cell",m.dataset.day=a,m.dataset.row=String(r);const d=document.createElement("div");d.className="schedule-cell-inner",m.appendChild(d),l.appendChild(m)}),s.appendChild(l)}n.appendChild(s),t.appendChild(n);const i=document.createElement("div");return i.className="schedule-overlay",t.appendChild(i),t}function at(t,n){return!(t.right<=n.left||t.left>=n.right||t.bottom<=n.top||t.top>=n.bottom)}function Nt(t,n){const e=Math.max(t.left,n.left),o=Math.min(t.right,n.right),s=Math.max(t.top,n.top),i=Math.min(t.bottom,n.bottom);return o<=e||i<=s?null:{left:e,right:o,top:s,bottom:i,width:o-e,height:i-s}}function Wt(t){const n=parseFloat(t.style.left)||0,e=parseFloat(t.style.top)||0,o=parseFloat(t.style.width)||0,s=parseFloat(t.style.height)||0;return{left:n,top:e,right:n+o,bottom:e+s,width:o,height:s}}function Gt(t,n){for(const e of n)if(at(t,e))return!0;return!1}function Ut(t,n,e){const o=t.querySelector(".schedule-overlay");o.innerHTML="";const s=t.querySelector(".schedule-table"),i=s.querySelector("tbody tr"),r=s.querySelector('tbody tr td.schedule-cell[data-day="Mon"]'),l=s.querySelector("thead th.schedule-time");if(!i||!r||!l)return;const c=l.getBoundingClientRect().width,a=r.getBoundingClientRect().width,m=s.querySelector("thead").getBoundingClientRect().height,d=i.getBoundingClientRect().height,L=getComputedStyle(r),D=parseFloat(L.borderLeftWidth)||0,T=parseFloat(L.borderTopWidth)||0,R=parseFloat(L.borderRightWidth)||0,_=parseFloat(L.borderBottomWidth)||0,F=(D+R)/2,P=(T+_)/2,A=[];j.forEach((S,w)=>{(n.get(S)||[]).forEach(u=>{const g=c+w*a,x=m+u.rowStart*d,C=u.rowSpan*d,f=document.createElement("div");f.className="schedule-entry-float",f.style.left=`${g+D}px`,f.style.top=`${x+T}px`,f.style.width=`${a-F}px`,f.style.height=`${C-P}px`;const y=document.createElement("div");y.className="schedule-entry-overlap-layer",f.appendChild(y);const v=document.createElement("div");v.className="schedule-entry-text";const B=u.code||u.title,$=u.label?`${B} ${u.label}`:B;v.innerHTML=`
        <div class="schedule-entry-title">${$}</div>
        <div class="schedule-entry-time">${u.timeLabel}</div>
      `,f.appendChild(v),o.appendChild(f),A.push({el:f,day:S,ev:u,rect:Wt(f),overlapLayerEl:y,overlaps:[],textEl:v})})});for(let S=0;S<A.length;S++)for(let w=S+1;w<A.length;w++){const b=A[S],u=A[w];if(b.day!==u.day||!at(b.rect,u.rect))continue;const g=Nt(b.rect,u.rect);if(!g)continue;b.el.style.opacity="0.75",u.el.style.opacity="0.75",b.el.classList.add("is-overlap"),u.el.classList.add("is-overlap");const x={left:g.left-b.rect.left,top:g.top-b.rect.top,width:g.width,height:g.height},C={left:g.left-u.rect.left,top:g.top-u.rect.top,width:g.width,height:g.height},f=document.createElement("div");f.className="schedule-entry-overlap-rect",f.style.left=`${x.left}px`,f.style.top=`${x.top}px`,f.style.width=`${x.width}px`,f.style.height=`${x.height}px`,b.overlapLayerEl.appendChild(f);const y=document.createElement("div");y.className="schedule-entry-overlap-rect",y.style.left=`${C.left}px`,y.style.top=`${C.top}px`,y.style.width=`${C.width}px`,y.style.height=`${C.height}px`,u.overlapLayerEl.appendChild(y)}const q=25,W=30,O=6,M=0;j.forEach(S=>{const w=A.filter(u=>u.day===S).sort((u,g)=>u.rect.top-g.rect.top),b=[];w.forEach(u=>{const g=u.rect.left+O;let x=u.rect.top+M,C=0;const f=u.rect.width-O*2,y=26;for(;C<W;){const v={left:g,top:x,right:g+f,bottom:x+y};if(v.bottom>u.rect.bottom-M)break;if(!Gt(v,b)){const B=x-u.rect.top;u.textEl.style.transform=`translateY(${B}px)`,b.push(v);return}x+=q,C++}u.textEl.style.transform=`translateY(${M}px)`,b.push({left:g,top:u.rect.top+M,right:g+f,bottom:u.rect.top+M+y})})})}function Zt(t,n,e){if(!t.scheduleGrid)return;t.scheduleGrid.innerHTML="";const o=_t(n),s=qt(o),i=Ot(s),r=Pt();t.scheduleGrid.appendChild(r),Ut(r,o),jt(t,i)}const it=t=>{if(t==null)return"";const n=String(t);return/[",\n]/.test(n)?`"${n.replace(/"/g,'""')}"`:n},Yt=(t,n)=>{const e=n.map(it).join(","),o=t.map(s=>n.map(i=>it(s[i]??"")).join(",")).join(`
`);return e+`
`+o};function Xt(){const t=["code","title","section_number","instructor","meeting","instructionalFormat"],n=Yt(p.filtered,t),e=new Blob([n],{type:"text/csv;charset=utf-8"}),o=URL.createObjectURL(e),s=document.createElement("a");s.href=o,s.download="captured-courses.csv",document.body.appendChild(s),s.click(),setTimeout(()=>{URL.revokeObjectURL(o),s.remove()},100)}(()=>{console.log("[WD] content script loaded");async function t(){const n=pt(),e=await ht(n);e.button.classList.toggle("is-collapsed",e.widget.classList.contains("is-hidden"));const o=()=>{Zt(e,p.filtered)},s=r=>{p.view.panel=r,e.panels.forEach(l=>{l.classList.toggle("is-active",l.dataset.panel===r)}),e.tabButtons.forEach(l=>{l.classList.toggle("is-active",l.dataset.panel===r)}),e.widget.classList.toggle("is-schedule-view",r==="schedule")},i=()=>{e.widget.classList.toggle("is-hidden"),e.button.classList.toggle("is-collapsed",e.widget.classList.contains("is-hidden"))};e.tabButtons.forEach(r=>{I(r,"click",()=>{s(r.dataset.panel),r.dataset.panel==="schedule"&&o()})}),e.semesterButtons.forEach(r=>{I(r,"click",()=>{p.view.semester=r.dataset.semester,e.semesterButtons.forEach(l=>{l.classList.toggle("is-active",l.dataset.semester===p.view.semester)}),o()})}),I(e.button,"click",i),chrome.runtime.onMessage.addListener(r=>{r?.type==="TOGGLE_WIDGET"&&i()}),I(e.refresh,"click",async()=>{p.courses=await Q(),et(e.search.value),U(p.sort.key||"code"),G(e,p.filtered),o()}),I(e.exportBtn,"click",Xt),I(e.settingsBtn,"click",()=>{e.widget.classList.remove("is-hidden"),e.button.classList.remove("is-collapsed"),s("settings")}),I(e.search,"input",ft(()=>{et(e.search.value),U(p.sort.key||"code"),G(e,p.filtered),o()},100)),Bt(e),p.courses=await Q(),p.filtered=[...p.courses],U("code"),G(e,p.filtered),o(),s(p.view.panel)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t,{once:!0}):t()})();
//# sourceMappingURL=content.js.map
